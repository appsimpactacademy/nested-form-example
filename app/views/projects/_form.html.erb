<%= form_with(model: project, local: true, html: { class: 'form' }) do |form| %>
  <% if project.errors.any? %>
    <div class="alert alert-danger" role="alert">
      <h4 class="alert-heading"><%= pluralize(project.errors.count, "error") %> prohibited this project from being saved:</h4>
      <ul>
        <% project.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="mb-3">
    <%= form.label :name, class: 'form-label' %>
    <%= form.text_field :name, class: 'form-control' %>
  </div>

  <div class="mb-3">
    <%= form.label :description, class: 'form-label' %>
    <%= form.text_area :description, class: 'form-control' %>
  </div>

  <div data-controller="tasks">
    <h3>Tasks</h3>
    <div id="tasks-list">
      <%= form.fields_for :tasks do |task_form| %>
        <div data-tasks-target="task">
          <%= render 'task_fields', f: task_form %>
        </div>
      <% end %>
    </div>

    <div class="d-flex justify-content-end mt-3">
      <%= link_to 'Add Task', '#', class: 'btn btn-primary', data: { action: 'click->tasks#addTask' } %>
    </div>
  </div>

  <%= render 'task_template' %>

  <div class="actions mt-3">
    <%= form.submit 'Save Project', class: 'btn btn-success' %>
  </div>
<% end %>
